<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="description" content="Древнекитайское гадание по Книге Перемен">
    <title>Ицзин - Книга Перемен</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icons/icon-192.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Статичный фон -->
    <img id="static-bg" src="assets/backgrounds/background-1.png" alt="Фон Ицзин">

    <div class="app-container">

        <!-- ЭКРАН 1: Главное меню -->
        <div id="main-menu" class="screen active">
            <div class="header">
                <!-- Заголовок убран, так как есть на фоне -->
            </div>
            
            <div class="menu-buttons-container">
                <button onclick="showScreen('about-screen')">О Ицзин</button>
                <button onclick="showScreen('warning-screen')">Предупреждение</button>
                <button onclick="showScreen('mode-selection-screen')">Начнём</button>
            </div>
        </div>

        <!-- ЭКРАН 2: Об Ицзин -->
        <div id="about-screen" class="screen">
            <h1>О гадании Ицзин</h1>
            <div class="text-content">
                <p><strong>Ицзин</strong>, или «Книга Перемен» — это древнейшая система мудрости, зародившаяся в Китае более трёх тысяч лет назад. Она является сокровищницей философских прозрений о природе изменений — вечном потоке превращений, который пронизывает всё сущее.</p>

                <p>В основе Ицзин лежит представление о Вселенной как о живом организме, где всё пребывает в движении: день сменяет ночь, зима — лето, покой — действие. Этот ритм отражён в двух фундаментальных силах: <em>Инь</em> (пассивное, принимающее, тёмное) и <em>Ян</em> (активное, творческое, светлое).</p>

                <p>Система Ицзин состоит из 64 гексаграмм — символических фигур, составленных из шести черт. Каждая гексаграмма представляет собой архетипическую жизненную ситуацию, а её черты — этапы развития этой ситуации.</p>

                <h3>Процесс получения гексаграммы</h3>
                <p>Есть несколько методов, но самый классический — с использованием 50 стеблей тысячелистника (долгий и медитативный) или трех монет (быстрый и популярный).</p>

                <p><strong>Метод трех монет:</strong></p>
                <ol>
                    <li>Вы берете три одинаковые монеты.</li>
                    <li>Задаете мысленно свой вопрос.</li>
                    <li>Бросаете монеты. Это повторяется 6 раз, чтобы построить 6 черт гексаграммы снизу вверх.</li>
                    <li>Каждому броску присваивается числовое значение:
                        <ul>
                            <li>3 орла = 9 (Старый ян → движущаяся черта)</li>
                            <li>2 орла, 1 решка = 8 (Молодая инь → стабильная черта)</li>
                            <li>2 решки, 1 орел = 7 (Молодой ян → стабильная черта)</li>
                            <li>3 решки = 6 (Старая инь → движущаяся черта)</li>
                        </ul>
                    </li>
                </ol>

                <h3>Анализ результата</h3>
                <p>После шести бросков вы получаете гексаграмму. Но на этом всё только начинается.</p>

                <ul>
                    <li><strong>Первичная гексаграмма:</strong> Описывает текущую ситуацию.</li>
                    <li><strong>Движущиеся линии:</strong> Черты со значениями 9 (Старый ян) и 6 (Старая инь) являются «движущимися». Это означает, что они превращаются в свою противоположность (ян в инь, инь в ян).</li>
                    <li><strong>Вторичная гексаграмма:</strong> После преобразования движущих линий вы получаете новую гексаграмму. Она показывает потенциальное развитие ситуации, к чему она может прийти.</li>
                </ul>

                <p>Таким образом, вы читаете толкования:</p>
                <ol>
                    <li>Основное толкование первичной гексаграммы.</li>
                    <li>Толкования конкретных движущихся линий (если они есть) в первичной гексаграмме. Это самые важные и конкретные советы.</li>
                    <li>Толкование вторичной гексаграммы.</li>
                </ol>

                <h3>Пример: Гексаграмма 1 (Цянь / Творчество)</h3>
                <ul>
                    <li><strong>Состав:</strong> Шесть сплошных черт Ян (9 или 7)</li>
                    <li><strong>Образ:</strong> Небо, творческая сила, энергия, инициатива</li>
                    <li><strong>Совет:</strong> Период огромной силы и возможностей. Успех придет через упорство и правильное руководство. Действуйте, но будьте мудры, как дракон, не проявляйте безрассудства.</li>
                </ul>

                <p>Если, например, в этой гексаграмме движущей является нижняя черта (9 в первой позиции), то ее текст может гласить: <em>«Скрытый дракон. Не действуй.»</em> — совет проявить смирение и выждать момент, несмотря на общую творческую энергию гексаграммы.</p>

                <p>Гадание на Ицзин — это не предсказание судьбы, а глубокий диалог с собственной интуицией. Когда вы бросаете монеты, вы не просто получаете случайную комбинацию — вы прикасаетесь к универсальным паттернам бытия, которые резонируют с вашим текущим жизненным контекстом.</p>

                <p>Каждая гексаграмма — это зеркало, отражающее суть момента. Она не говорит, что должно произойти, но раскрывает скрытые тенденции и глубинные взаимосвязи. Через её образы и афоризмы вы получаете доступ к коллективной мудрости поколений, помогающей увидеть ситуацию в новом свете.</p>

                <p>Ицзин учит искусству своевременности — умению распознавать благоприятные моменты для действия и периоды, когда мудрее сохранять покой. Это руководство по гармоничному существованию в мире, где изменение — единственная константа.</p>

                <p>Обращаясь к Ицзин, вы открываете пространство для саморефлексии и получаете перспективу, которая может осветить ваш путь через сложности и неопределённости современной жизни.</p>
            </div>
            <button onclick="showScreen('main-menu')">Назад</button>
        </div>

        <!-- ЭКРАН 3: Предупреждение -->
        <div id="warning-screen" class="screen">
            <h1>⚠️ Предупреждение</h1>
            <div class="text-content">
                <p class="main-warning">ОТНЕСИТЕСЬ С ПОНИМАНИЕМ</p>

                <h3>Суть гадания Ицзин:</h3>
                <p>Это древний инструмент для диалога с собственной интуицией, а не развлечение. Ответы приходят через универсальные символы-гексаграммы.</p>

                <h3>Правильный настрой:</h3>
                <ul>
                    <li>Относитесь к процессу серьезно</li>
                    <li>Задавайте только действительно важные вопросы</li>
                    <li>Верьте в процесс - это ключ к получению ответа</li>
                </ul>

                <h3>Как формулировать вопрос:</h3>
                <ul>
                    <li><strong>Искренне</strong> - от чистого сердца</li>
                    <li><strong>Открыто</strong> - "Как поступить?" вместо "Да/Нет"</li>
                    <li><strong>Лично</strong> - о том, на что можете повлиять</li>
                </ul>

                <h3>После получения ответа:</h3>
                <ul>
                    <li>Внимательно прочувствуйте его</li>
                    <li>Не записывайте - доверьтесь интуиции</li>
                    <li>Не переспрашивайте 6 месяцев</li>
                    <li>Ответ - не команда к действию, а пища для размышлений</li>
                </ul>

                <p><strong>Помните:</strong> Не важно, как бросаются монеты - важно ваше намерение. Вселенная отвечает тем, кто искренне ищет ответы.</p>
            </div>
            <button onclick="showScreen('main-menu')">Понятно</button>
        </div>

        <!-- ЭКРАН 4: Выбор режима гадания -->
        <div id="mode-selection-screen" class="screen">
            <div class="header">
                <h1 class="mode-selection-title">Выберите способ гадания</h1>
            </div>
            
            <div class="mode-buttons-container">
                <div class="mode-button" onclick="selectAutoMode()">
                    <div class="mode-title">Бросить монеты</div>
                    <div class="mode-subtitle">(Алгоритмом)</div>
                    <div class="mode-description">Монеты будут брошены программой</div>
                </div>
                
                <div class="mode-button" onclick="selectManualMode()">
                    <div class="mode-title">Бросить монеты</div>
                    <div class="mode-subtitle">(Вручную)</div>
                    <div class="mode-description">Вы бросаете монеты сами</div>
                </div>
            </div>

            <button onclick="showScreen('main-menu')" class="back-button">
                Назад
            </button>
        </div>

        <!-- ЭКРАН 5: Процесс гадания (АВТОМАТИЧЕСКИЙ РЕЖИМ) -->
        <div id="divination-screen" class="screen">
            <h2>Задайте свой вопрос мысленно</h2>

            <!-- Контейнер для монет -->
            <div class="coins-container">
                <img id="coin1" class="coin" src="assets/coins/ruble-heads.png" alt="Монета">
                <img id="coin2" class="coin" src="assets/coins/dollar-heads.png" alt="Монета">
                <img id="coin3" class="coin" src="assets/coins/yuan-heads.png" alt="Монета">
            </div>

            <!-- Единая кнопка для всего процесса -->
            <button id="action-button" onclick="handleAction()">Бросить монеты</button>

            <!-- ФИКСИРОВАННОЕ окно для гексаграммы -->
            <div class="hexagram-fixed-container">
                <div id="hexagram-lines">
                    <p>Бросьте монеты 6 раз чтобы построить гексаграмму</p>
                </div>
            </div>

            <!-- Кнопка Назад в меню - ВНИЗУ -->
            <button class="bottom-button" onclick="showScreen('mode-selection-screen')">Назад</button>
        </div>

        <!-- ЭКРАН 6: Гексаграмма (АВТОМАТИЧЕСКИЙ РЕЖИМ) -->
        <div id="result-screen" class="screen">
            <h1>Ваша гексаграмма</h1>
            <div id="final-hexagram"></div>
        </div>

        <!-- ЭКРАН 7: Толкование (АВТОМАТИЧЕСКИЙ РЕЖИМ) -->
        <div id="interpretation-screen" class="screen">
            <div class="meaning-overlay-container">
                <!-- ФОН-РАМКА -->
                <img src="assets/meanings/meaning-1.png" class="meaning-background-image" alt="Фон толкования">
                
                <!-- ТЕКСТОВАЯ ПОДЛОЖКА -->
                <div class="text-overlay-test">
                    <div class="text-content-test">
                        <h3 id="hexagram-name">Название гексаграммы</h3>
                        <div id="hexagram-description" class="test-text">
                            <!-- Текст будет загружен из JSON -->
                        </div>
                    </div>
                </div>
                
                <!-- Кнопка и заголовок -->
                <div class="meaning-content-overlay">
                    <h1>Толкование гексаграммы</h1>
                    <button onclick="showScreen('main-menu')">В главное меню</button>
                </div>
            </div>
        </div>

        <!-- ЭКРАН 8: Ручной ввод гексаграммы -->
        <div id="manual-input-screen" class="screen">
            <h2>Ручной ввод гексаграммы</h2>
            
            <div class="manual-instructions">
                <p>Бросьте 3 монеты 6 раз:</p>
                <p><strong>2-3 орла = Ян (⚊)</strong><br>
                   <strong>2-3 решки = Инь (⚋)</strong></p>
            </div>

            <div class="manual-lines-container">
                <!-- Линии будут добавляться здесь -->
            </div>
            
            <div class="yin-yang-button-container">
                <button class="yang-button" onclick="addManualLine('yang')">⚊ Ян</button>
                <button class="yin-button" onclick="addManualLine('yin')">⚋ Инь</button>
            </div>

            <div class="manual-action-buttons">
                <button onclick="clearManualLines()">Очистить</button>
                <button id="show-result-btn" onclick="showManualResult()" disabled>Результат</button>
            </div>
            
            <button onclick="showScreen('mode-selection-screen')" class="back-button">Назад</button>
        </div>

    </div>

    <!-- Сообщение об ошибках -->
    <div id="error-message" style="display: none; position: fixed; top: 10px; left: 10px; right: 10px; background: #ff4444; color: white; padding: 10px; border-radius: 5px; z-index: 1000; text-align: center;"></div>

    <script src="script.js"></script>
</body>
</html>
